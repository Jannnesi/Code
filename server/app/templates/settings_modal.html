{# Settings modal: uses a similar style to chart modal, but separate assets #}
{{ assets.style(url_for('static', filename='css/settings_modal.css')) if assets is defined else '' }}
{{ assets.script(url_for('static', filename='js/settings_modal.js')) if assets is defined else '' }}

<div id="settingsModal">
  <div class="dialog">
    <div class="header">
      <h3 id="settingsTitle">Settings</h3>
      <button id="closeSettings" aria-label="Close">✕</button>
    </div>

    <div class="content">
      <!-- Sleep Settings Panel -->
      <div id="sleepPanel" class="panel" hidden>
        <div class="form-grid">
          <div class="row">
            <label>Enabled</label>
            <button id="btnSleepToggle" class="btn">Enable Sleep</button>
          </div>
          <div class="row">
            <label for="sleepDisableMinutes">Disable sleep for</label>
            <div style="display:flex; gap:8px; align-items:center;">
              <input id="sleepDisableMinutes" type="number" step="5" min="5" value="30" title="Minutes" />
              <span class="sep">minutes</span>
              <button id="btnSleepDisableFor" class="btn">Apply</button>
            </div>
          </div>
          <div class="divider"></div>
          <div class="row"><em style="color:#aaa; font-size:0.9rem;">Overnight schedule per day: End = this day morning, Start = this day evening.</em></div>
          <div class="row"><label>Mon</label><input id="sleep_mon_stop" type="time" title="End (Monday morning)" /><input id="sleep_mon_start" type="time" title="Start (Monday evening)" /></div>
          <div class="row"><label>Tue</label><input id="sleep_tue_stop" type="time" title="End (Tuesday morning)" /><input id="sleep_tue_start" type="time" title="Start (Tuesday evening)" /></div>
          <div class="row"><label>Wed</label><input id="sleep_wed_stop" type="time" title="End (Wednesday morning)" /><input id="sleep_wed_start" type="time" title="Start (Wednesday evening)" /></div>
          <div class="row"><label>Thu</label><input id="sleep_thu_stop" type="time" title="End (Thursday morning)" /><input id="sleep_thu_start" type="time" title="Start (Thursday evening)" /></div>
          <div class="row"><label>Fri</label><input id="sleep_fri_stop" type="time" title="End (Friday morning)" /><input id="sleep_fri_start" type="time" title="Start (Friday evening)" /></div>
          <div class="row"><label>Sat</label><input id="sleep_sat_stop" type="time" title="End (Saturday morning)" /><input id="sleep_sat_start" type="time" title="Start (Saturday evening)" /></div>
          <div class="row"><label>Sun</label><input id="sleep_sun_stop" type="time" title="End (Sunday morning)" /><input id="sleep_sun_start" type="time" title="Start (Sunday evening)" /></div>
          {# Saving happens automatically on change #}
        </div>
      </div>

      <!-- Thermostat Settings Panel -->
      <div id="thermoPanel" class="panel" hidden>
        <div class="form-grid">
          <div class="row">
            <label>Sensors</label>
            <div id="ctrlLocContainer" class="loc-select"></div>
          </div>
          <div class="divider"></div>
          <div class="row">
            <label for="modalSetpointC">Target (°C)</label>
            <input class="field-input" id="modalSetpointC" type="number" step="0.1" min="5" max="35" />
          </div>
          <div class="row">
            <label for="modalHysteresisNeg">-Hysteresis (°C)</label>
            <input class="field-input" id="modalHysteresisNeg" type="number" step="0.1" min="0.1" max="10" />
          </div>
          <div class="row">
            <label for="modalHysteresisPos">+Hysteresis (°C)</label>
            <input class="field-input" id="modalHysteresisPos" type="number" step="0.1" min="0.1" max="10" />
          </div>
          <div class="row">
            <label for="modalMinOnS" title="Minimum time AC must stay ON once turned on (seconds)">Min ON (s)</label>
            <input class="field-input" id="modalMinOnS" type="number" step="1" min="0" />
          </div>
          <div class="row">
            <label for="modalMinOffS" title="Minimum time AC must stay OFF once turned off (seconds)">Min OFF (s)</label>
            <input class="field-input" id="modalMinOffS" type="number" step="1" min="0" />
          </div>
          <div class="row">
            <label for="modalPollS" title="Control loop sleep between steps (seconds)">Poll interval (s)</label>
            <input class="field-input" id="modalPollS" type="number" step="1" min="1" />
          </div>
          <div class="row">
            <label for="modalSmoothWindow" title="Rolling window size for temperature smoothing (points)">Smooth window</label>
            <input class="field-input" id="modalSmoothWindow" type="number" step="1" min="1" />
          </div>
          <div class="row">
            <label for="modalMaxStaleS" title="Ignore temperature readings older than this many seconds; leave blank to disable">Max stale (s)</label>
            <input class="field-input" id="modalMaxStaleS" type="number" step="1" min="0" placeholder="(blank = disabled)" />
          </div>
          {# Saving happens automatically on change #}
        </div>
      </div>
    </div>
  </div>
  <div class="backdrop" aria-hidden="true"></div>
</div>
