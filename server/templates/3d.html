<!-- 3d.html -->
<!DOCTYPE html>
<html lang="fi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sensor Dashboard</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/navbar.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/3d.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="{{ url_for('static', filename='js/socket.io.js') }}"></script>
  <!-- expose the API_KEY to our external script -->
  <script>window.API_KEY = {{ api_key|tojson }};</script>
  <script src="{{ url_for('static', filename='js/3d.js') }}"></script>
</head>
<body>
  <!-- Navigaatiopalkki -->
  <nav class="navbar">
    <ul>
      <li><a href="{{ url_for('get_home_page') }}">Home</a></li>
      <li><a href="{{ url_for('get_3d_page') }}">3D Dashboard</a></li>
      <li><a href="{{ url_for('settings') }}">Asetukset</a></li>
      <li><a href="{{ url_for('logout') }}">Kirjaudu Ulos</a></li>
    </ul>
  </nav>
  

  <div class="container">
      <!-- Kuvatile, joka kattaa koko rivin leveyden -->
      <div class="tile image-tile">
        <img src="data:image/jpeg;base64,{{ last_image['image'] }}" class="sensorImage" alt="Sensor Image">
      </div>
      <!-- Sensoridatan ruudukko -->
      <div class="data-grid">
        <div class="tile" id="tempTile">Temperature:<br> <strong id="temperature">{{ last_temphum['temperature'] }}°C</strong></div>
        <div class="tile" id="humTile">Humidity:<br> <strong id="humidity">{{ last_temphum['humidity'] }}%</strong></div>
        <div class="tile">Status:<br> <strong id="status">{{ last_status['status'] }}</strong></div>
      </div>
  </div>
  <!-- Chart Modal -->
  <div id="chartModal" style="
    display:none;
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.8); align-items:center; justify-content:center;
  ">
    <div style="background:#1e1e1e; padding:1rem; border-radius:8px; width:90%; max-width:600px;">
      <button id="closeModal" style="float:right;">✕</button>
      <h3 id="chartTitle" style="text-align:center; margin-bottom:0.5rem;"></h3>

      <div style="text-align:center; margin-bottom:0.5rem;">
        <button id="prevDay">← Edellinen</button>
        <span id="currentDate"></span>
        <button id="nextDay">Seuraava →</button>
      </div>

      <!-- NEW: Averages display -->
      <div id="averages" style="text-align:center; margin-bottom:0.5rem; color:#ccc;">
        <span id="avgTemp">Lämpötila: –</span> &nbsp;|&nbsp;
        <span id="avgHum">Kosteus: –</span>
      </div>

      <canvas id="chartCanvas" height="200"></canvas>
    </div>
  </div>
</body>
</html>
